<form [formGroup]="formgrp" (ngSubmit)="submit()">
   
    <div class="row mt-5">
      <div class="col-md-6">
        <div class="row mb-3">
            <div class="col-md-6">
              <label for="libelle">Libellé</label>
              <input type="text" class="form-control" id="libelle" name="libelle" formControlName="libelle" (input)="updateRef()">
            </div>
            <div class="col-md-6">
              <label for="categorie">Catégorie</label>
              <select class="form-select" id="categorie" name="categorie" (change)="updateRef($event)" >
                <option value="0"></option>
                <option  *ngFor="let categ of typeVenteCategories"  [value]="categ.id">{{categ.libelle}}</option>
              </select>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
              <div class="form-check">
                <input class="form-check-input" style="height: 1rem; width: 1rem;" type="checkbox" id="promo" name="promo" (click)="toggleCheck()">
                <label class="form-check-label" for="promo">Promo</label>
              </div>
            </div>
            <div class="col-md-6" *ngIf="promoChecked">
              <label for="autreChamp">Valeur</label>
              <input type="text" class="form-control" id="autreChamp" name="autreChamp" formControlName="promoValue">
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
              <div>Liste des articles de confection</div>
          
            </div>
            <div class="col-md-6">
                <button class="btn btn-primary" (click)="addConfection()">+</button>
                <!-- Génération du tableau (divs) ici -->
            </div>
            <div>

            </div>
            <div class="col-md-6">

              <div formArrayName="confections"  *ngFor="let table of confections.controls; let i=index">
                <div [formGroupName]="i">
  
                  <table class="table" >
                    <thead>
                      <tr>
                        <th>Libellé</th>
                        <th>Stock</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><input type="text" class="form-control" name="libelle" formControlName="libelle" (input)="searchConfection($event,i)"> 
                          <ul #fournisseurUl  *ngIf="isUlActive(i)"  >
                          <li *ngFor="let confec of filteredConfections" (click)="selectConfection(confec,i)">
                            {{confec.libelle}}
                          </li>
                          </ul>
                        </td>
                      
                        <td><input type="text" class="form-control" name="stock" formControlName="quantite"></td>
                      </tr>
                    </tbody>
                  </table>
                 
                  
    
                </div>
                
                </div>
              
            </div>
            
        

        </div>
        <div class="row mb-3">
            <div class="col-md-6">
              <label for="libelle">Cout Fabrication</label>
              <input type="text" class="form-control" id="libelle" name="libelle" formControlName="coutFabrication">
            </div>
            <div class="col-md-6">
                <label for="libelle">Marge/Article</label>
                <input type="text" class="form-control" id="libelle" name="libelle" formControlName="marge">
                <div *ngIf="formgrp.get('marge')?.hasError('margeRange')" style="color: red;">
                  Marge doit etre comprise entre 5000 and 1/3 du cout de fabrication.
                </div>
              </div>
        </div>
        <div class="row mb-3  ">
            <div class="col-md-6">
              <div class="form-check">
                <input class="form-control" type="text" id="" name="" formControlName="prix">
                <label  for="promo">Prix Vente</label>
              </div>
            </div>
        </div>
         
      </div>
  
      <div class="col-md-6 " style="padding-left:3rem ">
        <!-- Partie Droite -->
        <div class="row mb-3">
            <div class="col-md-6 mt-4">
                <div class="file-input" style="height: 15rem;">
                    <input
                      style="display: none;"
                      type="file"
                      id="form6Example2"
                      class="form-control"
                      (change)="previewImage($event)"

                    />
                    <label  for="form6Example2" style="width: 100%; height: 100%; cursor: pointer;">
                      <div style="width: 100%; height: 100%; position: relative;">
                        <div class="form-outline" style="position: absolute; width: 100%; height: 100%;">
                        </div>
                        <img
                          [src]="imagePreview"
                          alt=" "
                          style="width: 100%; height: 100%; display: block;"
                        />
                      </div>
                    </label>
                </div>
          </div>
        </div>  
          <div class="row">
            <div class="col-md-6 ref-div">
              <label for="ref">Référence</label>
              <input type="text" class="form-control" id="ref" name="ref" formControlName="ref">
            </div>
          </div>
          <div class="col-md-6 d-flex justify-content-end align-items-end"> <!-- Add classes to control alignment -->

            <button  type="submit" class="btn btn-primary  mb-4 subutn">submit</button>
            </div>
        </div>
      
    </div> 

</form>  